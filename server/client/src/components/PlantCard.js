import { jsx as _jsx, jsxs as _jsxs } from "react/jsx-runtime";
import { useState } from "react";
import { Droplet, BarChart2, Leaf } from "lucide-react";
import { LineChart, Line, XAxis, YAxis, Tooltip, ResponsiveContainer } from "recharts";
export default function PlantCard({ plant, onAddWatering }) {
    const [showPopup, setShowPopup] = useState(false);
    const [showChartPopup, setShowChartPopup] = useState(false);
    const [amount, setAmount] = useState(0);
    const handleSubmit = () => {
        if (amount > 0) {
            onAddWatering(plant._id, amount);
            setAmount(0);
            setShowPopup(false);
        }
    };
    const chartData = plant.waterings.map(w => ({
        date: new Date(w.date).toLocaleDateString(),
        amount: w.amount,
    }));
    return (_jsxs("div", { className: "bg-white shadow-lg rounded-xl p-4 flex flex-col gap-3 relative", children: [plant.imageUrl ? (_jsx("img", { src: plant.imageUrl, alt: plant.name, className: "w-full h-40 object-cover rounded-lg mb-2 shadow-sm" })) : (_jsx("div", { className: "w-full h-40 bg-gray-200 flex items-center justify-center rounded-lg mb-2", children: _jsx("span", { className: "text-gray-400 text-lg", children: "\uD83C\uDF31 No Image" }) })), _jsxs("div", { className: "flex justify-between items-center gap-2", children: [_jsxs("h3", { className: "text-green-800 font-bold text-lg flex items-center gap-1", children: [_jsx(Leaf, { size: 18 }), " ", plant.name] }), _jsxs("div", { className: "flex gap-2", children: [_jsxs("button", { onClick: () => setShowPopup(true), className: "flex items-center gap-1 text-white bg-green-500 hover:bg-green-600 px-3 py-1 rounded-lg shadow", children: [_jsx(Droplet, { size: 16 }), " Water"] }), _jsxs("button", { onClick: () => setShowChartPopup(true), className: "flex items-center gap-1 text-white bg-blue-500 hover:bg-blue-600 px-3 py-1 rounded-lg shadow", children: [_jsx(BarChart2, { size: 16 }), " View Chart"] })] })] }), _jsxs("div", { className: "text-sm text-gray-700 space-y-1", children: [plant.scientificName && (_jsxs("p", { children: ["\uD83E\uDDEC ", _jsx("span", { className: "italic", children: plant.scientificName })] })), plant.family && _jsxs("p", { children: ["\uD83C\uDF3F Family: ", plant.family] }), plant.apiId && _jsxs("p", { children: ["\uD83D\uDD16 Trefle ID: ", plant.apiId] })] }), _jsxs("div", { className: "text-sm text-gray-600 flex justify-between mt-2", children: [_jsxs("p", { children: ["Last watered: ", plant.lastWateredAt ? new Date(plant.lastWateredAt).toLocaleDateString() : "Never", " \uD83D\uDCA7"] }), _jsxs("p", { children: ["Next: ", plant.nextWateringAt ? new Date(plant.nextWateringAt).toLocaleDateString() : "TBD", " \u23F0"] })] }), plant.waterings.length > 0 && (_jsx("div", { style: { width: "100%", height: 100 }, className: "mt-2", children: _jsx(ResponsiveContainer, { children: _jsxs(LineChart, { data: chartData, children: [_jsx(XAxis, { dataKey: "date" }), _jsx(YAxis, {}), _jsx(Tooltip, {}), _jsx(Line, { type: "monotone", dataKey: "amount", stroke: "#10B981", strokeWidth: 2 })] }) }) })), showPopup && (_jsx("div", { className: "fixed inset-0 bg-black/30 flex items-center justify-center z-50", children: _jsxs("div", { className: "bg-white p-6 rounded-xl shadow-lg w-80", children: [_jsxs("h4", { className: "font-bold text-green-800 mb-2 flex items-center gap-1", children: [_jsx(Droplet, { size: 16 }), " Add Watering"] }), _jsx("input", { type: "number", min: 0, value: amount, onChange: e => setAmount(parseFloat(e.target.value)), placeholder: "Amount (ml)", className: "border rounded px-3 py-2 w-full mb-4" }), _jsxs("div", { className: "flex justify-end gap-2", children: [_jsx("button", { onClick: () => setShowPopup(false), className: "px-3 py-1 rounded bg-gray-200 hover:bg-gray-300", children: "Cancel" }), _jsx("button", { onClick: handleSubmit, className: "px-3 py-1 rounded bg-green-500 text-white hover:bg-green-600", children: "Add" })] })] }) })), showChartPopup && (_jsx("div", { className: "fixed inset-0 bg-black/50 flex items-center justify-center z-50", children: _jsxs("div", { className: "bg-white p-6 rounded-xl shadow-lg w-11/12 max-w-3xl h-96", children: [_jsxs("div", { className: "flex justify-between items-center mb-4", children: [_jsxs("h4", { className: "font-bold text-blue-600 flex items-center gap-1", children: [_jsx(BarChart2, { size: 18 }), " Watering History"] }), _jsx("button", { onClick: () => setShowChartPopup(false), className: "px-2 py-1 rounded bg-gray-200 hover:bg-gray-300", children: "Close" })] }), _jsx(ResponsiveContainer, { width: "100%", height: "90%", children: _jsxs(LineChart, { data: chartData, children: [_jsx(XAxis, { dataKey: "date" }), _jsx(YAxis, {}), _jsx(Tooltip, {}), _jsx(Line, { type: "monotone", dataKey: "amount", stroke: "#3B82F6", strokeWidth: 3 })] }) })] }) }))] }));
}
